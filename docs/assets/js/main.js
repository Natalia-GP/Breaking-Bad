"use strict";console.log("a単a単a単a単a");const btn=document.querySelector(".js-btn"),inputSearch=document.querySelector(".js-input"),listCharacter=document.querySelector(".js-list"),favCharacter=document.querySelector(".js-favourite");let allCharacter=[],searchList=[],favList=[];function renderAllCharacters(e,t){t.innerHTML="";for(const a of e)renderCharacters(a,t)}function renderCharacters(e,t){const a=document.createElement("li"),r=document.createElement("article"),c=document.createElement("img"),n=document.createElement("h3"),s=document.createElement("p");r.setAttribute("id",""+e.char_id),c.setAttribute("src",e.img),c.setAttribute("alt",""+e.name);const i=document.createTextNode(e.name),l=document.createTextNode(e.status);r.setAttribute("class","section__list__article"),c.setAttribute("class","section__list__article--img"),a.appendChild(r),r.appendChild(c),r.appendChild(n),r.appendChild(s),n.appendChild(i),s.appendChild(l),t.appendChild(a),addEvent()}function handleClick(e){e.preventDefault();const t=inputSearch.value;fetch("https://breakingbadapi.com/api/characters?name="+t).then(e=>e.json()).then(e=>{searchList=e,renderAllCharacters(searchList,listCharacter)})}function handleFavourites(e){e.preventDefault();const t=e.currentTarget;if(-1===searchArray(parseInt(t.id)))t.classList.add("favourite"),favList.push(allCharacter.find(e=>e.char_id===parseInt(t.id)));else{t.classList.remove("favourite");const e=searchArray(parseInt(t.id));favList.splice(e,1)}localStorage.setItem("favChar",JSON.stringify(favList)),renderAllCharacters(favList,favCharacter)}function searchArray(e){return favList.findIndex(t=>t.char_id===e)}function addEvent(){const e=document.querySelectorAll(".section__list__article");for(const t of e)t.classList.contains("aside__favourite__li--article")||t.addEventListener("click",handleFavourites)}fetch("./assets/data/characters.json").then(e=>e.json()).then(e=>{allCharacter=e,renderAllCharacters(allCharacter,listCharacter),addEvent(),localStorage.getItem("favChar")&&(favList=JSON.parse(localStorage.getItem("favChar")),renderAllCharacters(favList,favCharacter))}),btn.addEventListener("click",handleClick);